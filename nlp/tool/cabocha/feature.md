素性抽出について，まとめました


# 素性選択レイヤ (selector.cpp)
- https://code.google.com/p/cabocha/source/browse/trunk/src/selector.cpp
- 各文節Xに対して次のものをリストアップ
    - もしXが別の文節Dに係ったときは、DにつけるであろうA素性
    - もしXが別の文節Sから係られたときは、SにつけるであろうB素性

## 出力例
- これは古いバージョンの出力で，最新の出力とは微妙に異なる

```
* 0 -1D 0/1 0.000000 F_H0:太郎,F_H1:名詞,F_H2:固有名詞,F_H3:人名,F_H4:名,F_F0:は,F_F1:助詞,F_F2:係助詞,A:は,B:名詞-固有名詞-人名-名,G_CASE:は,F_BOS:1
太郎    名詞,固有名詞,人名,名,*,*,太郎,タロウ,タロー
は      助詞,係助詞,*,*,*,*,は,ハ,ワ
* 1 -1D 0/1 0.000000 F_H0:花子,F_H1:名詞,F_H2:固有名詞,F_H3:人名,F_H4:名,F_F0:が,F_F1:助詞,F_F2:格助詞,F_F3:一般,A:が,B:名詞-固有名詞-人名-名,G_CASE:が
花子    名詞,固有名詞,人名,名,*,*,花子,ハナコ,ハナコ
が      助詞,格助詞,一般,*,*,*,が,ガ,ガ
* 2 -1D 0/2 0.000000 F_H0:読ん,F_H1:動詞,F_H2:自立,F_H5:五段・マ行,F_H6:連用タ接続,F_F0:いる,F_F1:動詞,F_F2:非自立,F_F5:一段,F_F6:基本形,A:基本形,B:動詞-自立
読ん    動詞,自立,*,*,五段・マ行,連用タ接続,読む,ヨン,ヨン
で      助詞,接続助詞,*,*,*,*,で,デ,デ
いる    動詞,非自立,*,*,一段,基本形,いる,イル,イル
* 3 -1D 0/1 0.000000 F_H0:本,F_H1:名詞,F_H2:一般,F_F0:を,F_F1:助詞,F_F2:格助詞,F_F3:一般,A:を,B:名詞-一般,G_CASE:を
本      名詞,一般,*,*,*,*,本,ホン,ホン
を      助詞,格助詞,一般,*,*,*,を,ヲ,ヲ
* 4 -1D 1/2 0.000000 F_H0:郎,F_H1:名詞,F_H2:一般,F_F0:に,F_F1:助詞,F_F2:格助詞,F_F3:一般,A:に,B:名詞-一般,G_CASE:に
次      名詞,一般,*,*,*,*,次,ツギ,ツギ
郎      名詞,一般,*,*,*,*,郎,ロウ,ロー
に      助詞,格助詞,一般,*,*,*,に,ニ,ニ
* 5 -1D 0/1 0.000000 F_H0:渡し,F_H1:動詞,F_H2:自立,F_H5:五段・サ行,F_H6:連用形,F_F0:た,F_F1:助動詞,F_F5:特殊・タ,F_F6:基本形,A:基本形,B:動詞-自立,F_EOS:1
渡し    動詞,自立,*,*,五段・サ行,連用形,渡す,ワタシ,ワタシ
た      助動詞,*,*,*,特殊・タ,基本形,た,タ,タ
EOS
```

# selector_pat.hで定義されている定数
```
const char KUTOUTEN_PAT[] = "(。|、|,|.)";
const char OPEN_BRACKET_PAT [] = "((|（|‘|“|《|「|『|［|〈|｛)";
const char CLOSE_BRACKET_PAT[] = "()|）|’|”|》|」|』|］|〉|｝)";
const char DYN_A_PAT[] = "(助詞|副詞|連体詞|接続詞)";
const char CASE_PAT [] = "助詞";
//IPA
const char IPA_FUNC_PAT[] = "(助詞|助動詞|動詞,非自立|動詞,接尾|形容詞,非自立|形容詞,接尾)";
const char IPA_HEAD_PAT[] = "!(助詞|助動詞|動詞,非自立|動詞,接尾|形容詞,非自立|形容詞,接尾|空白|記号)";

//JUMAN
const char JUMAN_FUNC_PAT[] = "!特殊";
const char JUMAN_HEAD_PAT[] = "!(特殊|助詞|接尾辞)";

// UNIDIC
const char UNIDIC_FUNC_PAT[] = "(助詞|助動詞|接尾辞,形容詞的|接尾辞,形状詞的|接尾辞,動詞的|動詞,非自立可能|形容詞,非自立可能)"
const char UNIDIC_HEAD_PAT[] = "!(助詞|助動詞|接尾辞,形容詞的|接尾辞,形状詞的|接尾辞,動詞的|動詞,非自立可能|形容詞,非自立可能|空白|補助記号|記号)";
const char UNIDIC_FUNC_PAT2[] = "(助詞|助動詞|接尾辞,形容詞的|接尾辞,形状詞的|接尾辞,動詞的)"
const char UNIDIC_HEAD_PAT2[] = "!(助詞|助動詞|接尾辞,形容詞的|接尾辞,形状詞的|接尾辞,動詞的|空白|補助記号|記号)";
const char UNIDIC_HEAD_PRE_PAT[] = "(動詞,一般|形容詞,一般)";
```


#4種類の素性
- A素性(dyn_a) 「ある文節に既に係っている係り元の情報」
    - 機能辞が次の4つのどれかの品詞なら文字列そのもの、活用語ならその活用形(fcform)、それら以外なら品詞情報
    - ``//const char DYN_A_PAT = "(助詞|副詞|連体詞|接続詞)";``
- B素性(dyn_b) 「ある文節から既に係っている係り先の情報」
    - 主辞の品詞情報
- F素性(static) 「文節自体の持つ情報」
    - F_Hn 主辞の情報
    - F_Fn 機能語の情報
- G素性(gap) 「文節Sが文節Dにかかるとき、SとDの間に位置する文節の持つ情報」
    - 例文「私は彼の無垢な、あふれんばかりの才能に（ひそかに）嫉妬していた」
    - 「私は」が「嫉妬していた」に係るか？を考える
        - 途中に読点があるのでG_PUNC
        - 開・閉かっこがあるので G_OB, G_CB

# 素性の一覧
- chunk内のtokenに次のものがあれば，素性を発火
    - ``GPUNC, FPUNC`` 句読点の表層文字
    - ``GOB, FOB`` 開括弧の表層文字， ``GOB:1, FOB:1`` 開括弧の存在フラグ
    - ``GCB, FCB`` 閉括弧の表層文字， ``GCB:1, FCB:1`` 閉括弧の存在フラグ
    - ``GCASE`` 助詞の表層文字列	
- F素性 : static features
    - head token, func token, chunk内部の最左token, 最右tokenについて
        - emitTokenFeatures()関数で
            - ``S:`` 表層文字列
            - ``P0:, P1, ...`` tokenの付与されている情報(feature_list)
            - ``F:`` cforms
        - それぞれ，``FH, FF, FL, FR``というprefixをつける
            - 例 : ``FHS:``
    - ``FBOS:1``　文内の最初のchunkなら発火
    - ``FEOS:1``　文内の最後のchunkなら発火
- dynamic features
    - A素性 : 機能辞が次の4つのどれかの品詞なら文字列そのもの、活用語ならその活用形(fcform)、それら以外なら品詞情報
    - B素性 : ``This feature is not used for linear algorithm.``


# 参考文献
- http://yu-hatva.hatenablog.com/
